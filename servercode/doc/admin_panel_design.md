# 武器生成系统管理后台设计方案

## 1. 系统架构概述
- 单一配置文件：所有武器生成相关配置存储于 `data/weapon-config.json`。
- 文件管理：通过后台页面和 API 直接管理配置文件。
- 配置热重载：支持重载接口或重启服务后生效。
- 本地存储：原型阶段采用本地 JSON 文件，便于备份和手动编辑。

## 2. 技术栈
- 前端：简单 HTML 表单页面（`/public/admin.html`）。
- 后端：Vercel Serverless Functions (Node.js)。
- 存储：本地 JSON 文件。
- 认证：无（仅限本地/内网测试）。

## 3. 数据模型
- 配置文件结构参考 weapon-config.json，包含底材、词缀、品质三大部分。
- 每次修改均记录 `lastModified` 时间戳。

## 4. API接口设计
- `GET /api/admin/config`：获取当前配置。
- `POST /api/admin/config`：保存新配置。
- `POST /api/admin/config/reload`：重载配置文件。
- `POST /api/admin/preview-weapon`：用当前配置生成测试武器。

## 5. 管理后台界面设计
- 顶部操作栏：加载、保存、预览、重置。
- 配置编辑区：底材、词缀、品质表格编辑。
- 实时预览区：武器生成效果展示，配置基本验证。

## 6. 文件存储方案
- 配置文件：`/data/weapon-config.json`
- 备份目录：`/data/backup/`（可选，手动备份）

## 7. 工作流程
1. 打开后台页面，加载当前配置。
2. 编辑参数，预览武器效果。
3. 保存配置，调用重载接口或重启服务生效。
4. 如需回退，可手动恢复备份文件。

## 8. 错误处理
- 文件/JSON解析错误：返回具体错误信息。
- 数据格式错误：前端警告，不阻断操作。
- 配置损坏时自动回退到默认配置。

## 9. 开发优先级
- 第一阶段：配置读取/保存API，基础编辑界面。
- 第二阶段：武器预览、配置重载、简单数据校验。
- 可选：导入/导出、操作历史、数据统计。

---

> 本方案聚焦于原型阶段的快速配置管理，后续可根据实际需求扩展认证、云存储等功能。
